<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<title>title</title>
		<link rel="stylesheet" type="text/css" href="../css/api.css"/>
		<link rel="stylesheet" type="text/css" href="../css/lib/aui/aui-win.css"/>
		<style>
			body {
			}
		</style>
	</head>
	<body>
		<header class="aui-bar aui-bar-nav bar-bgcolor" style="padding-top:25px;">
			<a class="aui-pull-left"  tapmode onclick="close_win();"> <span class="aui-iconfont aui-icon-left aui-iconfont-size"></span> </a>
			<div class="aui-title">
				地图
			</div>
			<a class="aui-pull-right" tapmode onclick="open_user();"> <span class="aui-iconfont aui-icon-people right-icon"></span></a>
			<a class="aui-pull-right" tapmode onclick="close_win();"> <span class="aui-iconfont aui-icon-home aui-iconfont-size pad-left-10"></span> </a>
		</header>
	</body>
	<script type="text/javascript" src="../script/api.js"></script>
	<script type="text/javascript" src="../script/lib/jquery/jquery-1.10.1.min.js"></script>
	<script type="text/javascript" src="../script/common/module.js"></script>
	<script type="text/javascript">
		apiready = function() {
			var headerH = $api.offset($api.dom('header')).h
			$module.map.getLocation(function(ret) {
				$module.map.openMap({
					x : 0,
					y : headerH,
					width : api.winWidth,
					height : api.winHeight - headerH - 100
				}, {
					lon : 116.297,
					lat : 40.109
				}, function() {
					var map = api.require('bMap');
					map.addBillboard({
						id : 4,
						coords : {
							lon : 116.233,
							lat : 39.134
						},
						bgImg : 'widget://image/bMapTest.png',
						content : {
							title : '大标题大标题大标题大标题',
							subTitle : '概述内容概述内容概述内容',
							illus : 'http://ico.ooopic.com/ajax/iconpng/?id=145044.png'
						},
						styles : {
							titleColor : '#000',
							titleSize : 16,
							subTitleColor : '#999',
							subTitleSize : 12,
							illusAlign : 'left'
						}
					}, function(ret) {
						if (ret) {
							alert(JSON.stringify(ret));
						}
					});
					var map = api.require('bMap');
					map.addMobileAnnotations({
						annotations : [{
							id : 10,
							lon : 116.297,
							lat : 40.109,
							icon : 'widget://image/bMap_car1.png'
						}, {
							id : 11,
							lon : 116.98,
							lat : 40.109,
							icon : 'widget://image/bMap_car2.png'
						}, {
							id : 12,
							lon : 115.30,
							lat : 40.109,
							icon : 'widget://image/bMap_car3.png'
						}, {
							id : 13,
							lon : 116.297,
							lat : 39.109,
							icon : 'widget://image/bMap_car1.png'
						}, {
							id : 14,
							lon : 116.98,
							lat : 39.109,
							icon : 'widget://image/bMap_car2.png'
						}, {
							id : 15,
							lon : 115.30,
							lat : 39.109,
							icon : 'widget://image/bMap_car3.png'
						}]
					});
					setTimeout(move, 10000)
				})
			})
		};
		function move() {
			var map = api.require('bMap');
			for (var i = 0; i < 6; i++) {
				map.moveAnnotation({
					id : 10 + i,
					duration : 20,
					end : {
						lon : 116.3843839609304,
						lat : 39.98964439091298
					}
				}, function(ret, err) {
					alert(ret.id + '移动结束')
				});
			}
			map.moveAnnotation({
				id : 4,
				duration : 20,
				end : {
					lon : 116.3843839609304,
					lat : 39.98964439091298
				}
			}, function(ret, err) {
				alert(ret.id + '移动结束')
			});
		}
	</script>
</html>