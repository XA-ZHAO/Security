<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>Hello APP</title>
		<link rel="stylesheet" type="text/css" href="../css/api.css" />
		<link rel="stylesheet" type="text/css" href="../css/lib/aui/aui.css" />
		<style>
			#con {
				margin: 10px;
				font-size: 24px;
			}
			ul {
				margin-bottom: 10px;
			}
			ul li {
				margin: 5px 10px;
				padding: 5px;
				color: #000;
				word-wrap: break-word;
			}
		</style>
	</head>
	<body>
		<label id="con">Hello APP</label>
		<div id='sys-info'></div>
		<!--<div  onclick="settingAlarm()" class="aui-btn aui-btn-danger aui-btn-block aui-btn-outlined aui-btn-sm">
			设置闹铃
		</div>
		<div  onclick="open_map_frm()" class="aui-btn aui-btn-danger aui-btn-block aui-btn-outlined aui-btn-sm">
			打开地图
		</div>-->
		<li onclick="open_location()" class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-title">开始定位</div>
            </div>
        </li>
		 <li onclick="close_timer()" class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-title">关闭定时器</div>
            </div>
        </li>
	</body>
	<script type="text/javascript" src="../script/api.js"></script>
	<script type="text/javascript" src="../script/common/base.js"></script>
	<script type="text/javascript" src="../script/lib/jquery/jquery-1.10.1.js"></script>
	<script type="text/javascript" src="../script/lib/jquery/jquery.md5.js"></script>
	<script type="text/javascript" src="../script/common/common.js"></script>
	<script type="text/javascript" src="../script/common/module.js"></script>
	<script type="text/javascript" src="../script/common/webjs.js"></script>
	<script type="text/javascript">
		apiready = function() {
			api.addEventListener({
	            name:'online'
            },function(ret,err){
            	//coding...
            	alert('联网')
            });
		};
		open_map_frm = function() {
			api.openWin({
				name : 'map_win',
				url : "common/map_win.html"
			});
		}
		open_location = function() {
			var sysType = api.systemType
			alert(sysType)
			if (sysType == 'ios') {
				$module.map.getLocation(false, function(ret) {
					var json = {
						sysType : 'ios',
						location : ret
					}
					jqueryWebJs(json)
				})
			} else {
				$module.alarm.startAlarm(1000, 60000, function() {
					$module.map.getLocation(true, function(ret) {
						var json = {
							sysType : 'android',
							location : ret
						}
						jqueryWebJs(json)
					})
				})
			}
		}
		
		jqueryWebJs = function(request) {
			webRequest("userService.login", request, false, function(data) {
				console.log(JSON.stringify(data));
			}, function(ret) {
				console.log(JSON.stringify(ret));
			});
		}
	</script>
</html>